{"name":"Cassandra","tagline":"A Puppet module to install and manage Apache Cassandra.","body":"# cassandra\r\n[![Puppet Forge](http://img.shields.io/puppetforge/v/locp/cassandra.svg)](https://forge.puppetlabs.com/locp/cassandra)\r\n[![Github Tag](https://img.shields.io/github/tag/locp/cassandra.svg)](https://github.com/locp/cassandra)\r\n[![Build Status](https://travis-ci.org/locp/cassandra.png?branch=master)](https://travis-ci.org/locp/cassandra)\r\n[![Coverage Status](https://coveralls.io/repos/locp/cassandra/badge.svg?branch=master&service=github)](https://coveralls.io/github/locp/cassandra?branch=master)\r\n[![Join the chat at https://gitter.im/locp/cassandra](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/locp/cassandra?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)\r\n\r\n#### Table of Contents\r\n\r\n1. [Overview](#overview)\r\n2. [Setup - The basics of getting started with cassandra](#setup)\r\n    * [What cassandra affects](#what-cassandra-affects)\r\n    * [Beginning with cassandra](#beginning-with-cassandra)\r\n    * [Upgrading](#upgrading)\r\n3. [Usage - Configuration options and additional functionality](#usage)\r\n4. [Reference - An under-the-hood peek at what the module is doing and how](#reference)\r\n    * [cassandra](#class-cassandra)\r\n    * [cassandra::datastax_agent](#class-cassandradatastax_agent)\r\n    * [cassandra::java](#class-cassandrajava)\r\n    * [cassandra::optutils](#class-cassandraoptutils)\r\n5. [Limitations - OS compatibility, etc.](#limitations)\r\n6. [Contributers](#contributers)\r\n\r\n## Overview\r\n\r\nA Puppet module to install and manage Cassandra and DataStax Agent.\r\n\r\n## Setup\r\n\r\n### What the cassandra module affects\r\n\r\n#### What the cassandra class affects\r\n\r\n* Installs the Cassandra package (default **dsc21**).\r\n* Configures settings in *${config_path}/cassandra.yaml*.\r\n* Optionally ensures that the Cassandra service is enabled and running.\r\n* Optionally configures a Yum repository to install the Cassandra packages\r\n  from (on Red Hat).\r\n* Optionally configures an Apt repository to install the Cassandra packages\r\n  from (on Ubuntu).\r\n\r\n#### What the cassandra::datastax_agent class affects\r\n\r\n* Optionally installs the DataStax agent.\r\n\r\n#### What the cassandra::java class affects\r\n\r\n* Optionally installs a JRE/JDK package (e.g. java-1.7.0-openjdk).\r\n\r\n#### What the cassandra::optutils class affects\r\n\r\n* Optionally installs the Cassandra support tools (e.g. cassandra21-tools).\r\n\r\n### Beginning with cassandra\r\n\r\nThis most basic example would attempt to install the default Cassandra package\r\n(assuming there is an available repository).  See the *Usage*(#usage) section\r\nfor more realistic scenarios.\r\n\r\n```puppet\r\nnode 'example' {\r\n  include '::cassandra'\r\n}\r\n```\r\n\r\nTo install the DataStax agent, include the specific class.\r\n\r\n```puppet\r\nnode 'example' {\r\n  include '::cassandra'\r\n  include '::cassandra::datastax_agent'\r\n}\r\n```\r\n\r\nTo install with a reasonably sensible Java environment include the java\r\nsubclass.\r\n\r\n```puppet\r\nnode 'example' {\r\n  include '::cassandra'\r\n  include '::cassandra::java'\r\n}\r\n```\r\n\r\nTo install Cassandra with the optional utilities.\r\n\r\n```puppet\r\nnode 'example' {\r\n  include '::cassandra'\r\n  include '::cassandra::optutils'\r\n}\r\n```\r\n\r\nTo install the main cassandra package (which is mandatory) and all the\r\noptional packages, do the following:\r\n\r\n```puppet\r\nnode 'example' {\r\n  include '::cassandra'\r\n  include '::cassandra::datastax_agent'\r\n  include '::cassandra::java'\r\n  include '::cassandra::optutils'\r\n}\r\n```\r\n\r\nBy saying the cassandra class/package is mandatory, what is meant is that all\r\nthe sub classes have a dependency on the main class.  So for example one\r\ncould not specify the cassandra::java class for a node with the cassandra\r\nclass also being included.\r\n\r\n### Upgrading\r\n\r\nThe following changes to the API have taken place.\r\n\r\n#### Changes in 0.4.0\r\n\r\nThere is now a cassandra::datastax_agent class, therefore:\r\n\r\n* cassandra::datastax_agent_package_ensure has now been replaced with\r\n  cassandra::datastax_agent::package_ensure.\r\n* cassandra::datastax_agent_service_enable has now been replaced with\r\n  cassandra::datastax_agent::service_enable.\r\n* cassandra::datastax_agent_service_ensure has now been replaced with\r\n  cassandra::datastax_agent::service_ensure.\r\n* cassandra::datastax_agent_package_name has now been replaced with\r\n  cassandra::datastax_agent::package_name.\r\n* cassandra::datastax_agent_service_name has now been replaced with\r\n  cassandra::datastax_agent::service_name.\r\n\r\nLikewise now there is a new class for handling the installation of Java:\r\n\r\n* cassandra::java_package_ensure has now been replaced with\r\n  cassandra::java::ensure.\r\n* cassandra::java_package_name has now been replaced with\r\n  cassandra::java::package_name.\r\n\r\nAlso there is now a class for installing the optional utilities:\r\n\r\n* cassandra::cassandra_opt_package_ensure has now been replaced with\r\n  cassandra::optutils:ensure.\r\n* cassandra::cassandra_opt_package_name has now been replaced with\r\n  cassandra::optutils:package_name.\r\n\r\n#### Changes in 0.3.0\r\n\r\n* cassandra_opt_package_ensure changed from 'present' to undef.\r\n\r\n* The manage_service option has been replaced with service_enable and\r\n  service_ensure.\r\n\r\n## Usage\r\n\r\n### Create a Small Cluster\r\n\r\nTo install Cassandra in a two node cluster called 'Foobar Cluster' where\r\nnode1 (192.168.42.1) is the seed and node2 (192.168.42.2) is also to be a\r\nmember, do something similar to this:\r\n\r\n```puppet\r\ninclude cassandra::java\r\ninclude cassandra::optutils\r\n\r\nnode 'node1' {\r\n  class { 'cassandra':\r\n    cluster_name    => 'Foobar Cluster',\r\n    listen_address  => \"${::ipaddress}\",\r\n    seeds           => \"${::ipaddress}\",\r\n    manage_dsc_repo => true\r\n  }\r\n}\r\n\r\nnode 'node2' {\r\n  class { 'cassandra':\r\n    cluster_name    => 'Foobar Cluster',\r\n    listen_address  => \"${::ipaddress}\",\r\n    seeds           => '192.168.42.1',\r\n    manage_dsc_repo => true\r\n  }\r\n}\r\n```\r\n\r\nThis would also ensure that the JDK is installed and the optional Cassandra\r\ntools.\r\n\r\n## Reference\r\n\r\n### Public Classes\r\n\r\n* **cassandra**\r\n* **cassandra::datastax_agent**\r\n* **cassandra::java**\r\n* **cassandra::optutils**\r\n\r\n### Class: cassandra\r\n\r\nA class for installing the Cassandra package and manipulate settings in the\r\nconfiguration file.\r\n\r\n#### Parameters\r\n\r\n##### `authenticator`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **AllowAllAuthenticator**).\r\n\r\n##### `authorizer`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default: **AllowAllAuthorizer**).\r\n\r\n##### `auto_snapshot`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **true**).\r\n\r\n##### `cassandra_package_ensure`\r\nThe status of the package specified in **cassandra_package_name**.  Can be\r\n*present*, *latest* or a specific version number (default **present**).\r\n\r\n##### `cassandra_package_name`\r\nThe name of the Cassandra package.  Must be available from a repository\r\n(default **dsc21**).\r\n\r\n##### `cassandra_yaml_tmpl`\r\nThe path to the Puppet template for the Cassandra configuration file.  This\r\nallows the user to supply their own customized template.  A Cassandra 1.X\r\ncompatible template called cassandra1.yaml.erb has been provided by @Spredzy\r\n(default **cassandra/cassandra.yaml.erb**).\r\n\r\n##### `client_encryption_enabled`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **false**).\r\n\r\n##### `client_encryption_keystore`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **conf/.keystore**).\r\n\r\n##### `client_encryption_keystore_password`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **cassandra**).\r\n\r\n##### `cluster_name`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **Test Cluster**).\r\n\r\n##### `commitlog_directory`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **/var/lib/cassandra/commitlog**).\r\n\r\n##### `concurrent_counter_writes`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **32**).\r\n\r\n##### `concurrent_reads`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **32**).\r\n\r\n##### `concurrent_writes`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **32**).\r\n\r\n##### `config_path`\r\nThe path to the cassandra configuration file.  If this is undef, it will be\r\nchanged to **/etc/cassandra/default.conf** on the Red Hat family of operating\r\nsystems or **/etc/cassandra** on Ubuntu.  Otherwise the user can specify the\r\npath name\r\n(default **undef**).\r\n\r\n##### `data_file_directories`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **['/var/lib/cassandra/data']**).\r\n\r\n##### `disk_failure_policy`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default: **stop**).\r\n\r\n##### `endpoint_snitch`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default: **SimpleSnitch**).\r\n\r\n##### `hinted_handoff_enabled`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(defaults to **'true'**).\r\n\r\n##### `incremental_backups`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **false**).\r\n\r\n##### `internode_compression`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **all**).\r\n\r\n##### `listen_address`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **localhost**).\r\n\r\n##### `manage_dsc_repo`\r\nIf set to true then a repository will be setup so that packages can be\r\ndownloaded from the DataStax community edition (default **false**).\r\n\r\n##### `native_transport_port`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **9042**).\r\n\r\n##### `num_tokens`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **256**).\r\n\r\n##### `partitioner`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **org.apache.cassandra.dht.Murmur3Partitioner**)\r\n\r\n##### `rpc_address`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **localhost**).\r\n\r\n##### `rpc_port`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **9160**).\r\n\r\n##### `rpc_server_type`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **sync**).\r\n\r\n##### `saved_caches_directory`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **/var/lib/cassandra/saved_caches**).\r\n\r\n##### `seeds`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **127.0.0.1**).\r\n\r\n##### `server_encryption_internode`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **none**).\r\n\r\n##### `server_encryption_keystore`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **conf/.keystore**).\r\n\r\n##### `server_encryption_keystore_password`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **cassandra**).\r\n\r\n##### `server_encryption_truststore`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **conf/.truststore**).\r\n\r\n##### `server_encryption_truststore_password`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **cassandra**).\r\n\r\n##### `service_enable`\r\nEnable the Cassandra service to start at boot time.  Valid values are true\r\nor false\r\n(default: **true**)\r\n\r\n##### `service_ensure`\r\nEnsure the Cassandra service is running.  Valid values are running or stopped\r\n(default: **running**)\r\n\r\n##### `service_name`\r\nThe name of the service that runs the Cassandra software (default\r\n**cassandra**).\r\n\r\n##### `snapshot_before_compaction`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **false**).\r\n\r\n##### `start_native_transport`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **true**).\r\n\r\n##### `start_rpc`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **true**).\r\n\r\n##### `storage_port`\r\nThis is passed to the\r\n[cassandra.yaml](http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html) file\r\n(default **7000**).\r\n\r\n### Class: cassandra::datastax_agent\r\n\r\nA class for installing the DataStax agent and to point it at an Opscenter\r\ninstance.\r\n\r\n#### Parameters\r\n\r\n##### `package_ensure`\r\nIs passed to the package reference.  Valid values are **present** or a version\r\nnumber\r\n(default **present**).\r\n\r\n##### `package_name`\r\nIs passed to the package reference (default **datastax-agent**).\r\n\r\n##### `service_ensure`\r\nIs passed to the service reference (default **running**).\r\n\r\n##### `service_enable`\r\nIs passed to the service reference (default **true**).\r\n\r\n##### `service_name`\r\nIs passed to the service reference (default **datastax-agent**).\r\n\r\n##### `stomp_interface`\r\nIf the value is changed from the default of *undef* then this is what is\r\nset as the stomp_interface setting in\r\n**/var/lib/datastax-agent/conf/address.yaml**\r\nwhich connects the agent to an Opscenter instance\r\n(default **undef**).\r\n\r\n### Class: cassandra::java\r\n\r\nA class to install a reasonably sensible Java package.\r\n\r\n#### Parameters\r\n\r\n##### `ensure`\r\nIs passed to the package reference.  Valid values are **present** or a version\r\nnumber\r\n(default **present**).\r\n\r\n##### `package_name`\r\nIf the default value of *undef* is left as it is, then a package called\r\njava-1.8.0-openjdk-headless or openjdk-7-jre-headless will be installed\r\non a Red Hat family or Ubuntu system respectively.  Alternatively, one\r\ncan specify a package that is available in a package repository to the\r\nnode\r\n(default **undef**).\r\n\r\n### Class: cassandra::optutils\r\n\r\nA class to install the optional Cassandra tools package.\r\n\r\n#### Parameters\r\n\r\n##### `ensure`\r\nIs passed to the package reference.  Valid values are **present** or a version\r\nnumber\r\n(default **present**).\r\n\r\n##### `package_name`\r\nIf the default value of *undef* is left as it is, then a package called\r\ncassandra21-tools or cassandra-tools will be installed\r\non a Red Hat family or Ubuntu system respectively.  Alternatively, one\r\ncan specify a package that is available in a package repository to the\r\nnode\r\n(default **undef**).\r\n\r\n## Limitations\r\n\r\nTested on the Red Hat family versions 6 and 7, Ubuntu 12.04 and 14.04, Puppet\r\n(CE) 3.7.5 and DSC 2.1.\r\n\r\n## Contributers\r\n\r\nContributions will be gratefully accepted.  Please go to the project page,\r\nfork the project, make your changes locally and then raise a pull request.\r\nDetails on how to do this are available at\r\nhttps://guides.github.com/activities/contributing-to-open-source.\r\n\r\n### Additional Contributers\r\n\r\n* Yanis Guenane (GitHub [@spredzy](https://github.com/Spredzy)) provided the\r\nCassandra 1.x compatible template\r\n(see [#11](https://github.com/locp/cassandra/pull/11)).\r\n\r\n* Amos Shapira (GitHub [@amosshapira](https://github.com/amosshapira)) fixed\r\na bug in the requirements metadata that caused a problem with Puppetfile\r\n(see [#34](https://github.com/locp/cassandra/pull/34)).\r\n","google":"UA-6773548-6","note":"Don't delete this file! It's used internally to help with page regeneration."}